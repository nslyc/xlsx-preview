{"version":3,"file":"xlsxPreview.min.js","mappings":"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","sources":["webpack://xlsxPreview/webpack/bootstrap","webpack://xlsxPreview/webpack/runtime/define property getters","webpack://xlsxPreview/webpack/runtime/hasOwnProperty shorthand","webpack://xlsxPreview/webpack/runtime/make namespace object","webpack://xlsxPreview/external var \"ExcelJS\"","webpack://xlsxPreview/./src/utils.ts","webpack://xlsxPreview/./src/constants/base.ts","webpack://xlsxPreview/./src/htmls/genScripts.ts","webpack://xlsxPreview/./src/htmls/genHtmlStructure.ts","webpack://xlsxPreview/./src/images/genImages.ts","webpack://xlsxPreview/./src/CSSStyles/inline.ts","webpack://xlsxPreview/./src/htmls/genCell.ts","webpack://xlsxPreview/./src/htmls/genText.ts","webpack://xlsxPreview/./src/htmls/genSheet.ts","webpack://xlsxPreview/./src/CSSStyles/base.ts","webpack://xlsxPreview/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = ExcelJS;","export function parseARGB(argb: string) {\r\n  if (argb.length !== 8) throw \"This is not a standard argb string.\";\r\n  const color: string[] = [];\r\n  for (let i = 0; i < 4; i++) {\r\n    color.push(argb.substr(i * 2, 2));\r\n  }\r\n  const [a, r, g, b] = color.map((v) => parseInt(v, 16));\r\n  return { a, r, g, b };\r\n}\r\n\r\nfunction toAndJoinHex(range: Uint8Array): string {\r\n  let result: string = \"\";\r\n  for (const v of range) {\r\n    let to16 = v.toString(16);\r\n    while (to16.length < 2) {\r\n      to16 = \"0\" + to16;\r\n    }\r\n    result += to16;\r\n  }\r\n  return result;\r\n}\r\n\r\nexport function uuid() {\r\n  const view = crypto.getRandomValues(new Uint8Array(8));\r\n  const front = view.slice(0, 4);\r\n  const end = view.slice(4);\r\n  const fontPart = toAndJoinHex(front);\r\n  const endPart = toAndJoinHex(end);\r\n  return `${fontPart}-${endPart}`;\r\n}\r\n","import { uuid } from \"../utils\";\r\n\r\nexport const UUID = uuid();\r\n\r\nexport const EXCEL_SHEETS_CLS = `excel-sheets-${UUID}`;\r\n\r\nexport const TABLE_CLS = `table-${UUID}`;\r\nexport const TBODY_CLS = `tbody-${UUID}`;\r\nexport const SHEET_CLS = `sheet-${UUID}`;\r\nexport const SHEET_TOGGLE_BAR_CLS = `sheet-toggle-bar-${UUID}`;\r\nexport const SHEET_LOCATE_BTN_X = `locate-btns-x-${UUID}`;\r\nexport const SHEET_LOCATE_BTN_CLS = `l-btn-${UUID}`;\r\nexport const SHEET_TOGGLE_BTN_X = `toggle-btns-x-${UUID}`;\r\nexport const SHEET_TOGGLE_BTN_CLS = `t-btn-${UUID}`;\r\n\r\nexport const CELL_HEIGHT = 24;\r\nexport const CELL_WIDTH = 72;\r\nexport const TABLE_BORDER_COLOR = \"#f0f0f0\";\r\nexport const ORDER_CELL_BACKGROUND = \"#b6d9fb\";\r\n\r\nexport const FIRST_ORDER_ROW_HEIGHT = 24;\r\nexport const FIRST_ORDER_COL_WIDTH = 32;\r\n\r\nconst DEFAULT_NUMBER_ROWS = 20;\r\nconst DEFAULT_NUMBER_COLS = 16;\r\nexport let MINIMUM_NUMBER_ROWS = DEFAULT_NUMBER_ROWS;\r\nexport let MINIMUM_NUMBER_COLS = DEFAULT_NUMBER_COLS;\r\n\r\nexport function setMinimumNumberRows(count: number) {\r\n  if (count < DEFAULT_NUMBER_ROWS) {\r\n    console.warn(\"setMinimumNumberRows: count less then DEFAULT_NUMBER_ROWS.\");\r\n  }\r\n  MINIMUM_NUMBER_ROWS = count;\r\n}\r\n\r\nexport function setMinimumNumberCols(count: number) {\r\n  if (count < DEFAULT_NUMBER_COLS) {\r\n    console.warn(\"setMinimumNumberCols: count less then DEFAULT_NUMBER_COLS.\");\r\n  }\r\n  MINIMUM_NUMBER_COLS = count;\r\n}\r\n","import {\n  SHEET_CLS,\n  SHEET_LOCATE_BTN_CLS,\n  SHEET_LOCATE_BTN_X,\n  SHEET_TOGGLE_BTN_CLS,\n  SHEET_TOGGLE_BTN_X,\n  UUID,\n} from \"constants/base\";\n\nconst toggleBtnEventBind = `\nfunction toggleBtnEventBind() {\n  document.querySelector('.${SHEET_TOGGLE_BTN_X}').addEventListener('click',e => {\n    const target = e.target;\n    if(target.classList.contains('${SHEET_TOGGLE_BTN_CLS}')) {\n      const index = target.dataset.index;\n      setActiveByIndex(index);\n    }\n  })\n}\n`;\n\nconst calcOffset = `\nconst sheetBtnOffsetMap = (function calcSheetToggleBtnOffset() {\n  const result = [];\n  const btns = document.querySelectorAll(\".${SHEET_TOGGLE_BTN_CLS}\");\n  btns.forEach((ele, idx) => {\n    result[idx] = ele.offsetLeft;\n  });\n  return result;\n})();\n`;\n\nconst setActiveByIndex = `\nfunction setActiveByIndex(index) {\n  document.querySelector('.${SHEET_TOGGLE_BTN_CLS}.active').classList.remove('active');\n  document.querySelector('.${SHEET_CLS}.active').classList.remove('active');\n  document.querySelector('.${SHEET_TOGGLE_BTN_CLS}[data-index=\"' + index + '\"]').classList.add(\"active\");\n  document.querySelector('.${SHEET_CLS}[data-index=\"' + index + '\"]').classList.add(\"active\");\n}\n`;\n\nconst toPrevOffsetIndex = `\nfunction toPrevOffsetIndex(toggleBtnX) {\n  if (offsetIndex === 0) return;\n  const scrollLeft = toggleBtnX.scrollLeft;\n  const scrollWidth = toggleBtnX.scrollWidth;\n  const offsetWidth = toggleBtnX.offsetWidth;\n  const maxOffset = scrollWidth - offsetWidth;\n  let idx = offsetIndex - 1;\n  while (idx >= 0) {\n    let cur = sheetBtnOffsetMap[idx];\n    if (cur < maxOffset) {\n      toggleBtnX.scrollTo({ left: cur });\n      offsetIndex = idx;\n      break;\n    }\n    idx--;\n  }\n}\n`;\n\nconst locateBtnEventBind = `\nlet offsetIndex = 0;\nfunction locateBtnEventBind() {\n  document.querySelector('.${SHEET_LOCATE_BTN_X}').addEventListener('click', e => {\n    const target = e.target;\n    if (target.classList.contains('${SHEET_LOCATE_BTN_CLS}')) {\n      const toggleBtnX = document.querySelector('.${SHEET_TOGGLE_BTN_X}');\n      switch (target.id) {\n        case 'first-${UUID}':\n          toggleBtnX.scrollTo({ left: 0 });\n          offsetIndex = 0;\n          break;\n        case 'last-${UUID}':\n          toggleBtnX.scrollTo({ left: sheetBtnOffsetMap[sheetBtnOffsetMap.length - 1] })\n          offsetIndex = sheetBtnOffsetMap.length - 1;\n          break;\n        case 'prev-${UUID}':\n          toPrevOffsetIndex(toggleBtnX);\n          break;\n        case 'next-${UUID}':\n          if (offsetIndex === sheetBtnOffsetMap.length - 1) return;\n          toggleBtnX.scrollTo({ left: sheetBtnOffsetMap[++offsetIndex] });\n          break;\n        default:\n          break;\n      }\n    }\n  })\n}\n`;\nexport default function genScripts() {\n  const scripts = `\n  <script>\n    ${toggleBtnEventBind}\n    ${calcOffset}\n    ${setActiveByIndex}\n    ${toPrevOffsetIndex}\n    ${locateBtnEventBind}\n    window.onload = function() {\n      toggleBtnEventBind();\n      locateBtnEventBind();\n    }\n  </script>`;\n  return scripts;\n}\n","import { Worksheet } from \"exceljs\";\r\nimport {\r\n  SHEET_TOGGLE_BTN_CLS,\r\n  SHEET_TOGGLE_BTN_X,\r\n  SHEET_CLS,\r\n  TABLE_CLS,\r\n  TBODY_CLS,\r\n  UUID,\r\n  EXCEL_SHEETS_CLS,\r\n  SHEET_LOCATE_BTN_X,\r\n  SHEET_LOCATE_BTN_CLS,\r\n  SHEET_TOGGLE_BAR_CLS,\r\n} from \"../constants/base\";\r\nimport { genToggleSheetCSS } from \"../CSSStyles/base\";\r\nimport genScripts from \"./genScripts\";\r\n\r\nconst EMPTY_ROW_CACHE: { [key: number]: string } = {};\r\nexport function genEmptyRow(columns: number, orderCell: string): string {\r\n  if (EMPTY_ROW_CACHE[columns])\r\n    return `<tr>${orderCell}${EMPTY_ROW_CACHE[columns]}</tr>`;\r\n  let cells = \"\";\r\n  for (let i = 1; i <= columns; i++) {\r\n    cells += `<td></td>`;\r\n  }\r\n  EMPTY_ROW_CACHE[columns] = cells;\r\n  return `<tr>${orderCell}${cells}</tr>`;\r\n}\r\n\r\nexport function wrapTable(html: string): string {\r\n  return `<body class=\"embed-body-${UUID}\">\r\n        <table class=\"${TABLE_CLS}\">\r\n            <tbody class=\"${TBODY_CLS}\">${html}</tbody>\r\n        </table>\r\n    </body>`;\r\n}\r\n\r\nexport function sheetsInAll(sheets: string[], workSheet: Worksheet[]) {\r\n  let html = \"\";\r\n  let buttons = \"\";\r\n  for (let i = 0; i < sheets.length; i++) {\r\n    const MIME_TYPE = \"text/html\";\r\n    const url = URL.createObjectURL(new Blob([sheets[i]], { type: MIME_TYPE }));\r\n    const active = i === 0 ? \" active\" : \"\";\r\n    html += `<object class=\"${SHEET_CLS}${active}\" data-index=\"${i}\" type=\"${MIME_TYPE}\" data=\"${url}\"></object>`;\r\n    buttons += `<button class=\"${SHEET_TOGGLE_BTN_CLS}${active}\" data-index=\"${i}\">${workSheet[i].name}</button>`;\r\n  }\r\n  const locateBtns = `<div class=\"${SHEET_LOCATE_BTN_X}\">\r\n    <button class=\"${SHEET_LOCATE_BTN_CLS}\" id=\"first-${UUID}\">⇤</button>\r\n    <button class=\"${SHEET_LOCATE_BTN_CLS}\" id=\"prev-${UUID}\">←</button>\r\n    <button class=\"${SHEET_LOCATE_BTN_CLS}\" id=\"next-${UUID}\">→</button>\r\n    <button class=\"${SHEET_LOCATE_BTN_CLS}\" id=\"last-${UUID}\">⇥</button>\r\n  </div>`;\r\n  const toggleBtns = `<div class=\"${SHEET_TOGGLE_BTN_X}\">${buttons}</div>`;\r\n  html += `<div class=\"${SHEET_TOGGLE_BAR_CLS}\">${locateBtns}${toggleBtns}</div>`;\r\n  html += `${genToggleSheetCSS()}${genScripts()}`;\r\n  return `<div class=\"${EXCEL_SHEETS_CLS}\">${html}</div>`;\r\n}\r\n","import { ImageRange, Worksheet } from \"exceljs\";\r\nimport { ImagePosAndSize, RowsAndColsSpanMap } from \"../types/table\";\r\n\r\nfunction calcImgPosAndSize(\r\n  range: ImageRange,\r\n  positionMap: RowsAndColsSpanMap\r\n): ImagePosAndSize {\r\n  const { rows, cols } = positionMap;\r\n  const { tl, br } = range;\r\n  const offsetLeft = (tl.col - tl.nativeCol) * cols[Math.ceil(tl.col)];\r\n  const offsetTop = (tl.row - tl.nativeRow) * rows[Math.ceil(tl.row)];\r\n  let baseLeft = 0;\r\n  for (let k = tl.nativeCol; k >= 0; k--) {\r\n    baseLeft += cols[k];\r\n  }\r\n  let baseTop = 0;\r\n  for (let k = tl.nativeRow; k >= 0; k--) {\r\n    baseTop += rows[k];\r\n  }\r\n  const left = baseLeft + offsetLeft;\r\n  const top = baseTop + offsetTop;\r\n\r\n  const offsetRight = (br.col - br.nativeCol) * cols[Math.ceil(br.col)];\r\n  const offsetBottom = (br.col - br.nativeCol) * rows[Math.ceil(br.row)];\r\n  let baseRight = 0;\r\n  for (let k = br.nativeCol; k >= 0; k--) {\r\n    baseRight += cols[k];\r\n  }\r\n  let baseBottom = 0;\r\n  for (let k = br.nativeRow; k >= 0; k--) {\r\n    baseBottom += rows[k];\r\n  }\r\n  const width = baseRight + offsetRight - left;\r\n  const height = baseBottom + offsetBottom - top;\r\n  return {\r\n    left,\r\n    top,\r\n    width,\r\n    height,\r\n  };\r\n}\r\n\r\nfunction regulateImgPosAndSize(\r\n  res: ImagePosAndSize,\r\n  range: ImageRange,\r\n  positionMap: RowsAndColsSpanMap\r\n): ImagePosAndSize {\r\n  if (res.width) return res;\r\n  const { cols } = positionMap;\r\n  const { tl, br } = range;\r\n  const width = (br.nativeColOff - tl.nativeColOff) / 10000;\r\n  const leftOffset = tl.nativeColOff / 10000;\r\n\r\n  let baseLeft = 0;\r\n  for (let k = tl.nativeCol; k >= 0; k--) {\r\n    baseLeft += cols[k];\r\n  }\r\n  const left = baseLeft + leftOffset;\r\n  return {\r\n    ...res,\r\n    left,\r\n    width,\r\n  };\r\n}\r\n\r\nexport async function genImageHtml(\r\n  workSheet: Worksheet,\r\n  positionMap: RowsAndColsSpanMap\r\n): Promise<string> {\r\n  const images = workSheet.getImages();\r\n  let imageHtml = \"\";\r\n  for (const img of images) {\r\n    let pos = calcImgPosAndSize(img.range, positionMap);\r\n    const { left, top, width, height } = regulateImgPosAndSize(\r\n      pos,\r\n      img.range,\r\n      positionMap\r\n    );\r\n    const styles = `position: absolute; left: ${left}px; top: ${top}px; width: ${width}px; height: ${height}px;`;\r\n    const imgData = workSheet.workbook.getImage(img.imageId as any as number);\r\n    const type = `image/${imgData.extension}`;\r\n    if (imgData.base64) {\r\n      imageHtml += `<img src=\"${imgData.base64}\" style=\"${styles}\" />`;\r\n    } else if (imgData.buffer) {\r\n      const url = URL.createObjectURL(new Blob([imgData.buffer], { type }));\r\n      imageHtml += `<object type=\"${type}\" data=\"${url}\" style=\"${styles}\"></object>`;\r\n    }\r\n  }\r\n  return imageHtml;\r\n}\r\n","import { Alignment, Fill, Font } from \"exceljs\";\r\nimport { parseARGB } from \"../utils\";\r\n\r\nexport function genAlignment(alignment: Partial<Alignment>): string {\r\n  let styles = \"\";\r\n  const { horizontal, vertical, indent, readingOrder } = alignment;\r\n  if (horizontal) styles += `text-align: ${horizontal};`;\r\n  if (vertical) styles += `vertical-align: ${vertical};`;\r\n  if (indent) styles += `text-indent: ${indent};`;\r\n  if (readingOrder) styles += `direction: ${readingOrder};`;\r\n  return styles;\r\n}\r\n\r\nexport function genFont(font: Partial<Font>): string {\r\n  let styles = \"\";\r\n  const { bold, italic, family, name, size, underline, color } = font;\r\n  if (bold) styles += \"font-weight: bold;\";\r\n  if (italic) styles += \"font-style: italic;\";\r\n  if (family) styles += `font-family: ${name};`;\r\n  if (size) styles += `font-size: ${size}px;`;\r\n  if (underline) styles += \"text-decoration: underline;\";\r\n  if (color && color.argb) styles += `color: ${genColor(color.argb)};`;\r\n  return styles;\r\n}\r\n\r\nexport function genFill(fill: Fill): string {\r\n  const { type } = fill;\r\n  if (type === \"pattern\") {\r\n    const { fgColor, bgColor } = fill;\r\n    if (fgColor && fgColor.argb) {\r\n      const color = genColor(fgColor.argb);\r\n      return `background-color: ${color};`;\r\n    } else if (bgColor && bgColor.argb) {\r\n      const color = genColor(bgColor.argb);\r\n      return `background-color: ${color};`;\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\n\r\nexport function genColor(argb: string) {\r\n  const { a, r, g, b } = parseARGB(argb);\r\n  return `rgba(${r},${g},${b},${a / 255})`;\r\n}\r\n","import {\n  Cell,\n  CellHyperlinkValue,\n  CellRichTextValue,\n  ValueType,\n} from \"exceljs\";\nimport { genAlignment, genFill, genFont } from \"../CSSStyles/inline\";\nimport { CellSpan } from \"../types/table\";\nimport { genDate, genForMulaValue, genHyperLink, genRichText } from \"./genText\";\n\nfunction genCellTextByType(cell: Cell): string {\n  const { type, value } = cell;\n  switch (type) {\n    case ValueType.Null:\n      return '';\n    case ValueType.Hyperlink:\n      return genHyperLink(value as CellHyperlinkValue);\n    case ValueType.RichText:\n      return genRichText(value as CellRichTextValue);\n    case ValueType.Formula:\n      return genForMulaValue(cell);\n    case ValueType.Date:\n      return genDate(value as Date);\n    default:\n      return (value as string) || \"\";\n  }\n}\n\nfunction computedCellSpan(cell: Cell) {\n  if (!cell.isMerged || cell.master !== cell) return null;\n  const { row, col } = cell.fullAddress;\n  // find the next merged cell\n  let nextRow = row + 1;\n  let nextCell: Cell | undefined;\n  do {\n    nextCell = cell.worksheet.findCell(nextRow++, col);\n  } while (nextCell && nextCell.master === cell);\n  let nextCol = col + 1;\n  nextCell = undefined;\n  do {\n    nextCell = cell.worksheet.findCell(row, nextCol++);\n  } while (nextCell && nextCell.master === cell);\n  const cellSpan: CellSpan = {};\n  if (nextRow - row > 1) {\n    cellSpan.row = nextRow - row - 1;\n  }\n  if (nextCol - col > 1) {\n    cellSpan.col = nextCol - col - 1;\n  }\n  return cellSpan;\n}\n\nexport function genCell(cell: Cell) {\n  let colRowData: CellSpan | null = null;\n  if (cell.isMerged) {\n    // If cell is merged and it isn't the master.\n    if (cell.master !== cell) return \"\";\n    colRowData = computedCellSpan(cell);\n  }\n  let text = genCellTextByType(cell);\n  let cellAttrs = \"\";\n  if (colRowData) {\n    if (colRowData.col) cellAttrs += ` colspan=\"${colRowData.col}\"`;\n    if (colRowData.row) cellAttrs += ` rowspan=\"${colRowData.row}\"`;\n  }\n  let curCellStyle = \"\";\n  if (cell.font) curCellStyle += genFont(cell.font);\n  if (cell.alignment) curCellStyle += genAlignment(cell.alignment);\n  if (cell.fill) curCellStyle += genFill(cell.fill);\n  if (curCellStyle) cellAttrs += ` style=\"${curCellStyle}\"`;\n  return `<td${cellAttrs}>${text}</td>`;\n}\n","import { Cell, CellHyperlinkValue, CellRichTextValue } from \"exceljs\";\nimport { genFont } from \"../CSSStyles/inline\";\n\nexport function genHyperLink(value: CellHyperlinkValue): string {\n  return `<a href=\"${value.hyperlink}\" target=\"_blank\">${value.text}</a>`;\n}\n\nexport function genRichText(value: CellRichTextValue): string {\n  const richText = (value as CellRichTextValue).richText;\n  let text = \"\";\n  for (const rich of richText) {\n    let styles = \"\";\n    if (rich.font) {\n      styles = genFont(rich.font);\n    }\n    if (styles) {\n      text += `<span style=\"${styles}\">${rich.text}</span>`;\n    } else {\n      text += `<span>${rich.text}</span>`;\n    }\n  }\n  return text;\n}\n\nexport function genForMulaValue(cell: Cell): string {\n  if (cell.numFmt === \"0.00%\") {\n    return ((cell.result as number) * 100).toFixed(2) + \"%\";\n  } else {\n    return cell.result as string || \"\";\n  }\n}\n\nexport function genDate(value: Date): string {\n  return value.toString();\n}\n","import { Row, Worksheet } from \"exceljs\";\nimport {\n  CELL_HEIGHT,\n  CELL_WIDTH,\n  FIRST_ORDER_COL_WIDTH,\n  FIRST_ORDER_ROW_HEIGHT,\n  MINIMUM_NUMBER_COLS,\n  MINIMUM_NUMBER_ROWS,\n  TABLE_CLS,\n  TBODY_CLS,\n} from \"../constants/base\";\nimport { genBaseCSS } from \"../CSSStyles/base\";\nimport { genImageHtml } from \"../images/genImages\";\nimport { RowsAndColsSpanMap } from \"../types/table\";\nimport { genCell } from \"./genCell\";\nimport { genEmptyRow, wrapTable } from \"./genHtmlStructure\";\n\nfunction genRows(\n  rows: RowsMap,\n  maxRow: number,\n  maxCol: number,\n  workSheet: Worksheet\n) {\n  let resultRows = \"\";\n  const rowsSpan: number[] = [];\n  for (let index = 1; index <= maxRow; index++) {\n    let result = \"\";\n    const orderCell = `<td class=\"order order-row\">${index}</td>`;\n    let rowHeight: number;\n    // add default.\n    if (!rows[index]) {\n      rowHeight = CELL_HEIGHT;\n      result += genEmptyRow(maxCol, orderCell);\n    } else {\n      // generate cells.\n      const { height } = rows[index];\n      let cellsResult = \"\";\n      for (let j = 1; j <= maxCol; j++) {\n        const curCell = workSheet.findCell(index, j);\n        if (!curCell) {\n          cellsResult += \"<td></td>\";\n        } else {\n          cellsResult += genCell(curCell);\n        }\n      }\n      let rowAttrs = \"\";\n      if (height) {\n        rowAttrs += ` style=\"height:${height}px;\"`;\n        rowHeight = height;\n      } else {\n        rowHeight = CELL_HEIGHT;\n      }\n      result += `<tr${rowAttrs}>${orderCell}${cellsResult}</tr>`;\n    }\n\n    resultRows += result;\n    rowsSpan[index] = rowHeight;\n  }\n  return { resultRows, rowsSpan };\n}\n\nfunction genOrderCols(maxCol: number, workSheet: Worksheet) {\n  const curDefaultColWidth = workSheet.properties.defaultColWidth || 9;\n  let sheetWidth = 0;\n  let orderCol = '<td class=\"order order-row\"></td>';\n  let colStyles = \"\";\n  const colsSpan: number[] = [];\n  for (let j = 1; j <= maxCol; j++) {\n    const column = workSheet.getColumn(j);\n    orderCol += `<td class=\"order order-col index-${j}\">${column.letter}</td>`;\n    if (!column.width) {\n      sheetWidth += CELL_WIDTH;\n      colsSpan[j] = CELL_WIDTH;\n    } else {\n      const curCellWidth = (column.width * CELL_WIDTH) / curDefaultColWidth;\n      colsSpan[j] = curCellWidth;\n      sheetWidth += curCellWidth;\n      colStyles += `.${TBODY_CLS} td.index-${j} { width: ${curCellWidth}px; }`;\n    }\n  }\n  return {\n    sheetWidth,\n    orderCol,\n    colStyles,\n    colsSpan,\n  };\n}\n\ninterface RowsMap {\n  [key: string]: Row;\n}\nexport default async function genSheet(workSheet: Worksheet) {\n  const positionMap: RowsAndColsSpanMap = {\n    rows: [],\n    cols: [],\n  };\n  // generate rows.\n  const rows: RowsMap = {};\n  workSheet.eachRow((row, rowNumber) => {\n    rows[rowNumber] = row;\n  });\n  const lastRow = (workSheet.lastRow && workSheet.lastRow.number) || 0;\n  const maxRow = Math.max(lastRow, MINIMUM_NUMBER_ROWS);\n  const lastColumn = (workSheet.lastColumn && workSheet.lastColumn.number) || 0;\n  const maxCol = Math.max(lastColumn, MINIMUM_NUMBER_COLS);\n\n  const { resultRows, rowsSpan } = genRows(rows, maxRow, maxCol, workSheet);\n  positionMap.rows = [FIRST_ORDER_ROW_HEIGHT, ...rowsSpan];\n  const { sheetWidth, orderCol, colStyles, colsSpan } = genOrderCols(\n    maxCol,\n    workSheet\n  );\n  positionMap.cols = [FIRST_ORDER_COL_WIDTH, ...colsSpan];\n\n  const hideGridLines = workSheet.views.some((view) => !view.showGridLines);\n  const gridLineStyle = hideGridLines\n    ? `.${TBODY_CLS}.${TBODY_CLS} td:not(.order) { border: none; }`\n    : \"\";\n\n  let result = wrapTable(orderCol + resultRows);\n  const tableStyle = `.${TABLE_CLS} { width: ${sheetWidth}px; } ${gridLineStyle}`;\n  const imgHtml = await genImageHtml(workSheet, positionMap);\n  result += imgHtml;\n  result += `<style>${tableStyle}${colStyles}</style>`;\n  result += genBaseCSS();\n  return result;\n}\n","import {\r\n  SHEET_TOGGLE_BTN_CLS,\r\n  SHEET_TOGGLE_BTN_X,\r\n  TABLE_BORDER_COLOR,\r\n  CELL_HEIGHT,\r\n  CELL_WIDTH,\r\n  SHEET_CLS,\r\n  TABLE_CLS,\r\n  TBODY_CLS,\r\n  UUID,\r\n  EXCEL_SHEETS_CLS,\r\n  ORDER_CELL_BACKGROUND,\r\n  SHEET_TOGGLE_BAR_CLS,\r\n  SHEET_LOCATE_BTN_X,\r\n  SHEET_LOCATE_BTN_CLS,\r\n} from \"../constants/base\";\r\n\r\nexport function genBaseCSS(): string {\r\n  const base = `\r\n    <style>\r\n      .embed-body-${UUID} { margin: 0; padding: 0; }\r\n      .${TABLE_CLS} { border-collapse: collapse; table-layout: fixed; }\r\n      .${TBODY_CLS} { border-right: 1px solid ${TABLE_BORDER_COLOR}; border-bottom: 1px solid ${TABLE_BORDER_COLOR}; }\r\n      .${TBODY_CLS} td { border-left: 1px solid ${TABLE_BORDER_COLOR}; border-top: 1px solid ${TABLE_BORDER_COLOR}; width: ${CELL_WIDTH}px; height: ${CELL_HEIGHT}px; }\r\n      .${TBODY_CLS} td.order { color: #333; text-align: center; background: ${ORDER_CELL_BACKGROUND}; }\r\n      .${TBODY_CLS} td.order-row { width: 32px; }\r\n    </style>`;\r\n  return base;\r\n}\r\n\r\nexport function genToggleSheetCSS(): string {\r\n  return `\r\n    <style>\r\n      body { margin-bottom: 0; }\r\n      .${EXCEL_SHEETS_CLS} { position: relative; }\r\n      .${SHEET_CLS} { display: none; width: 100%; height: calc(100% - 30px); }\r\n      .${SHEET_CLS}.active { display: block; }\r\n      .${SHEET_TOGGLE_BAR_CLS} { position: fixed; left: 0px; bottom: 0px; width: 100%; display: flex; }\r\n      .${SHEET_LOCATE_BTN_X} { display: flex; algin-items: center; margin-right: 1px; }\r\n      .${SHEET_LOCATE_BTN_CLS} { height: 30px; border: none; }\r\n      .${SHEET_LOCATE_BTN_CLS}:active { background: #fff; }\r\n      .${SHEET_TOGGLE_BTN_X} { position: relative; flex: 1; overflow: hidden; white-space: nowrap; }\r\n      .${SHEET_TOGGLE_BTN_CLS} { height: 30px; padding: 0 15px; border: none; box-shadow: 1px 0 2px #ccc; }\r\n      .${SHEET_TOGGLE_BTN_CLS}.active { border-bottom: 2px solid; background: #fff; }\r\n    </style>`;\r\n}\r\n","import { Workbook } from \"exceljs\";\r\nimport { setMinimumNumberCols, setMinimumNumberRows } from \"./constants/base\";\r\nimport { sheetsInAll } from \"./htmls/genHtmlStructure\";\r\nimport genSheet from \"./htmls/genSheet\";\r\nimport { XlsxData, XlsxOptions } from \"./types\";\r\n\r\nexport async function xlsx2Html(data: XlsxData, options?: XlsxOptions) {\r\n  if (options?.minimumRows) {\r\n    setMinimumNumberRows(options.minimumRows);\r\n  }\r\n  if (options?.minimumCols) {\r\n    setMinimumNumberCols(options.minimumCols);\r\n  }\r\n  let buffer: ArrayBuffer;\r\n  if (data instanceof Blob) {\r\n    buffer = await data.arrayBuffer();\r\n  } else if (data instanceof ArrayBuffer) {\r\n    buffer = data;\r\n  } else {\r\n    throw \"xlsx2Html(data, options): The parameter data can only be passed ArrayBuffer, Blob or File type\";\r\n  }\r\n  const workbook = new Workbook();\r\n  await workbook.xlsx.load(buffer);\r\n  const sheetsLen = workbook.worksheets.length;\r\n  const sheets: string[] = [];\r\n  for (let idx = 0; idx < sheetsLen; idx++) {\r\n    const result = await genSheet(workbook.worksheets[idx]);\r\n    sheets.push(result);\r\n  }\r\n  // Separate sheets.\r\n  if (options?.separateSheets === true) {\r\n    if (options.output === \"arrayBuffer\") {\r\n      const all = sheets.map((sheet) => toBuffer(sheet));\r\n      return all;\r\n    }\r\n    return sheets;\r\n  }\r\n  const result = sheetsInAll(sheets, workbook.worksheets);\r\n  // Output ArrayBuffer\r\n  if (options?.output === \"arrayBuffer\") {\r\n    return toBuffer(result);\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction toBuffer(data: string) {\r\n  const blob = new Blob([data], { type: \"text/html\" });\r\n  return blob.arrayBuffer();\r\n}\r\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","ExcelJS","toAndJoinHex","range","result","v","to16","toString","length","UUID","view","crypto","getRandomValues","Uint8Array","front","slice","end","uuid","EXCEL_SHEETS_CLS","TABLE_CLS","TBODY_CLS","SHEET_CLS","SHEET_TOGGLE_BAR_CLS","SHEET_LOCATE_BTN_X","SHEET_LOCATE_BTN_CLS","SHEET_TOGGLE_BTN_X","SHEET_TOGGLE_BTN_CLS","MINIMUM_NUMBER_ROWS","MINIMUM_NUMBER_COLS","toggleBtnEventBind","calcOffset","setActiveByIndex","locateBtnEventBind","EMPTY_ROW_CACHE","genEmptyRow","columns","orderCell","cells","i","calcImgPosAndSize","positionMap","rows","cols","tl","br","offsetLeft","col","nativeCol","Math","ceil","offsetTop","row","nativeRow","baseLeft","k","baseTop","left","top","offsetRight","offsetBottom","baseRight","baseBottom","width","height","regulateImgPosAndSize","res","nativeColOff","leftOffset","genFont","font","styles","bold","italic","family","name","size","underline","color","argb","genColor","a","r","g","b","push","substr","map","parseInt","parseARGB","genCell","cell","colRowData","isMerged","master","fullAddress","nextCell","nextRow","worksheet","findCell","nextCol","undefined","cellSpan","computedCellSpan","text","type","ValueType","hyperlink","genHyperLink","richText","rich","genRichText","numFmt","toFixed","genForMulaValue","genDate","genCellTextByType","cellAttrs","curCellStyle","alignment","horizontal","vertical","indent","readingOrder","genAlignment","fill","fgColor","bgColor","genFill","genSheet","workSheet","eachRow","rowNumber","lastRow","number","maxRow","max","lastColumn","maxCol","resultRows","rowsSpan","index","rowHeight","cellsResult","j","curCell","rowAttrs","genRows","sheetWidth","orderCol","colStyles","colsSpan","curDefaultColWidth","properties","defaultColWidth","column","getColumn","letter","curCellWidth","genOrderCols","gridLineStyle","views","some","showGridLines","tableStyle","imgHtml","images","getImages","imageHtml","img","pos","imgData","workbook","getImage","imageId","extension","base64","buffer","URL","createObjectURL","Blob","genImageHtml","xlsx2Html","data","options","count","minimumRows","console","warn","minimumCols","setMinimumNumberCols","arrayBuffer","ArrayBuffer","Workbook","xlsx","load","sheetsLen","worksheets","sheets","idx","separateSheets","output","sheet","toBuffer","html","buttons","MIME_TYPE","url","active","sheetsInAll"],"sourceRoot":""}