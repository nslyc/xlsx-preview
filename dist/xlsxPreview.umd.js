!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("ExcelJS")):"function"==typeof define&&define.amd?define(["ExcelJS"],e):"object"==typeof exports?exports.xlsxPreview=e(require("ExcelJS")):t.xlsxPreview=e(t.ExcelJS)}(self,(function(t){return(()=>{"use strict";var e={799:e=>{e.exports=t}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var l=n[t]={exports:{}};return e[t](l,l.exports,o),l.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{o.r(r),o.d(r,{xlsx2Html:()=>g});var t=o(799);function e(t){let e="";for(const n of t){let t=n.toString(16);for(;t.length<2;)t="0"+t;e+=t}return e}const n=function(){const t=crypto.getRandomValues(new Uint8Array(8)),n=t.slice(0,4),o=t.slice(4);return`${e(n)}-${e(o)}`}(),l=`excel-sheets-${n}`,i=`table-${n}`,s=`tbody-${n}`,a=`sheet-${n}`,c=`sheet-btn-${n}`,d=`btns-x-${n}`;let f=20,u=16;const p={};function b(t,e){if(p[t])return`<tr>${e}${p[t]}</tr>`;let n="";for(let e=1;e<=t;e++)n+="<td></td>";return p[t]=n,`<tr>${e}${n}</tr>`}function h(t,e){const{rows:n,cols:o}=e,{tl:r,br:l}=t,i=(r.col-r.nativeCol)*o[Math.ceil(r.col)],s=(r.row-r.nativeRow)*n[Math.ceil(r.row)];let a=0;for(let t=r.nativeCol;t>=0;t--)a+=o[t];let c=0;for(let t=r.nativeRow;t>=0;t--)c+=n[t];const d=a+i,f=c+s,u=(l.col-l.nativeCol)*o[Math.ceil(l.col)],p=(l.col-l.nativeCol)*n[Math.ceil(l.row)];let b=0;for(let t=l.nativeCol;t>=0;t--)b+=o[t];let h=0;for(let t=l.nativeRow;t>=0;t--)h+=n[t];return{left:d,top:f,width:b+u-d,height:h+p-f}}function $(t,e,n){if(t.width)return t;const{cols:o}=n,{tl:r,br:l}=e,i=(l.nativeColOff-r.nativeColOff)/1e4,s=r.nativeColOff/1e4;let a=0;for(let t=r.nativeCol;t>=0;t--)a+=o[t];const c=a+s;return Object.assign(Object.assign({},t),{left:c,width:i})}function x(t){let e="";const{bold:n,italic:o,family:r,name:l,size:i,underline:s,color:a}=t;return n&&(e+="font-weight: bold;"),o&&(e+="font-style: italic;"),r&&(e+=`font-family: ${l};`),i&&(e+=`font-size: ${i}px;`),s&&(e+="text-decoration: underline;"),a&&a.argb&&(e+=`color: ${y(a.argb)};`),e}function y(t){const{a:e,r:n,g:o,b:r}=function(t){if(8!==t.length)throw"This is not a standard argb string.";const e=[];for(let n=0;n<4;n++)e.push(t.substr(2*n,2));const[n,o,r,l]=e.map((t=>parseInt(t,16)));return{a:n,r:o,g:r,b:l}}(t);return`rgba(${n},${o},${r},${e/255})`}function w(e){let n=null;if(e.isMerged){if(e.master!==e)return"";n=function(t){if(!t.isMerged||t.master!==t)return null;const{row:e,col:n}=t.fullAddress;let o,r=e+1;do{o=t.worksheet.findCell(r++,n)}while(o&&o.master===t);let l=n+1;o=void 0;do{o=t.worksheet.findCell(e,l++)}while(o&&o.master===t);const i={};return r-e>1&&(i.row=r-e-1),l-n>1&&(i.col=l-n-1),i}(e)}let o=function(e){const{type:n,value:o}=e;switch(n){case t.ValueType.Hyperlink:return function(t){return`<a href="${t.hyperlink}" target="_blank">${t.text}</a>`}(o);case t.ValueType.RichText:return function(t){const e=t.richText;let n="";for(const t of e){let e="";t.font&&(e=x(t.font)),n+=e?`<span style="${e}">${t.text}</span>`:`<span>${t.text}</span>`}return n}(o);case t.ValueType.Date:return function(t){return t.toString()}(o);default:return o||""}}(e),r="";n&&(n.col&&(r+=` colspan="${n.col}"`),n.row&&(r+=` rowspan="${n.row}"`));let l="";return e.font&&(l+=x(e.font)),e.alignment&&(l+=function(t){let e="";const{horizontal:n,vertical:o,indent:r,readingOrder:l}=t;return n&&(e+=`text-align: ${n};`),o&&(e+=`vertical-align: ${o};`),r&&(e+=`text-indent: ${r};`),l&&(e+=`direction: ${l};`),e}(e.alignment)),e.fill&&(l+=function(t){const{type:e}=t;if("pattern"===e){const{fgColor:e,bgColor:n}=t;if(e&&e.argb)return`background-color: ${y(e.argb)};`;if(n&&n.argb)return`background-color: ${y(n.argb)};`}return""}(e.fill)),l&&(r+=` style="${l}"`),`<td${r}>${o}</td>`}function m(t){return e=this,o=void 0,l=function*(){const e={rows:[],cols:[]},o={};t.eachRow(((t,e)=>{o[e]=t}));const r=t.lastRow&&t.lastRow.number||0,l=Math.max(r,f),a=t.lastColumn&&t.lastColumn.number||0,c=Math.max(a,u),{resultRows:d,rowsSpan:p}=function(t,e,n,o){let r="";const l=[];for(let i=1;i<=e;i++){let e="";const s=`<td class="order order-row">${i}</td>`;let a;if(t[i]){const{height:r}=t[i];let l="";for(let t=1;t<=n;t++){const e=o.findCell(i,t);l+=e?w(e):"<td></td>"}let c="";r?(c+=` style="height:${r}px;"`,a=r):a=24,e+=`<tr${c}>${s}${l}</tr>`}else a=24,e+=b(n,s);r+=e,l[i]=a}return{resultRows:r,rowsSpan:l}}(o,l,c,t);e.rows=[24,...p];const{sheetWidth:x,orderCol:y,colStyles:m,colsSpan:g}=function(t,e){const n=e.properties.defaultColWidth||9;let o=0,r='<td class="order order-row"></td>',l="";const i=[];for(let a=1;a<=t;a++){const t=e.getColumn(a);if(r+=`<td class="order order-col index-${a}">${t.letter}</td>`,t.width){const e=72*t.width/n;i[a]=e,o+=e,l+=`.${s} td.index-${a} { width: ${e}px; }`}else o+=72,i[a]=72}return{sheetWidth:o,orderCol:r,colStyles:l,colsSpan:i}}(c,t);e.cols=[32,...g];let v=`<body class="embed-body-${n}">\n        <table class="${i}">\n            <tbody class="${s}">${y+d}</tbody>\n        </table>\n    </body>`;const C=`.${i} { width: ${x}px; }`,S=yield function(t,e){return n=this,o=void 0,l=function*(){const n=t.getImages();let o="";for(const r of n){let n=h(r.range,e);const{left:l,top:i,width:s,height:a}=$(n,r.range,e),c=`position: absolute; left: ${l}px; top: ${i}px; width: ${s}px; height: ${a}px;`,d=t.workbook.getImage(r.imageId),f=`image/${d.extension}`;d.base64?o+=`<img src="${d.base64}" style="${c}" />`:d.buffer&&(o+=`<object type="${f}" data="${URL.createObjectURL(new Blob([d.buffer],{type:f}))}" style="${c}"></object>`)}return o},new((r=void 0)||(r=Promise))((function(t,e){function i(t){try{a(l.next(t))}catch(t){e(t)}}function s(t){try{a(l.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(i,s)}a((l=l.apply(n,o||[])).next())}));var n,o,r,l}(t,e);return v+=S,v+=`<style>${C}${m}</style>`,v+=`\n    <style>\n      .embed-body-${n} { margin: 0; padding: 0; }\n      .${i} { border-collapse: collapse; table-layout: fixed; }\n      .${s} { border-right: 1px solid #f0f0f0; border-bottom: 1px solid #f0f0f0; }\n      .${s} td { border-left: 1px solid #f0f0f0; border-top: 1px solid #f0f0f0; width: 72px; height: 24px; }\n      .${s} td.order { color: #333; text-align: center; background: #b6d9fb; }\n      .${s} td.order-row { width: 32px; }\n    </style>`,v},new((r=void 0)||(r=Promise))((function(t,n){function i(t){try{a(l.next(t))}catch(t){n(t)}}function s(t){try{a(l.throw(t))}catch(t){n(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(i,s)}a((l=l.apply(e,o||[])).next())}));var e,o,r,l}function g(e,n){return o=this,r=void 0,s=function*(){var o;let r;if((null==n?void 0:n.minimumRows)&&((o=n.minimumRows)<20&&console.warn("setMinimumNumberRows: count less then DEFAULT_NUMBER_ROWS."),f=o),(null==n?void 0:n.minimumCols)&&function(t){t<16&&console.warn("setMinimumNumberCols: count less then DEFAULT_NUMBER_COLS."),u=t}(n.minimumCols),e instanceof Blob)r=yield e.arrayBuffer();else{if(!(e instanceof ArrayBuffer))throw"xlsx2Html(data, options): The parameter data can only be passed ArrayBuffer, Blob or File type";r=e}const i=new t.Workbook;yield i.xlsx.load(r);const s=i.worksheets.length,p=[];for(let t=0;t<s;t++){const e=yield m(i.worksheets[t]);p.push(e)}if(!0===(null==n?void 0:n.separateSheets))return"arrayBuffer"===n.output?p.map((t=>v(t))):p;const b=function(t,e){let n="",o="";for(let r=0;r<t.length;r++){const l="text/html",i=URL.createObjectURL(new Blob([t[r]],{type:l})),s=0===r?" active":"";n+=`<object class="${a}${s}" data-index="${r}" type="${l}" data="${i}"></object>`,o+=`<button class="${c}${s}" data-index="${r}">${e[r].name}</button>`}return n+=`<div class="${d}">${o}</div>`,n+=`\n    <style>\n      .${l} { position: relative; padding-bottom: 26px; }\n      .${a} { display: none; width: 100%; height: 100%; }\n      .${a}.active { display: block; }\n      .${d} { position: fixed; left: 0px; bottom: 0px; display: flex; }\n      .${c} { height: 30px; padding: 0 15px; border: none; box-shadow: 1px 0 2px #ccc; }\n      .${c}.active { border-bottom: 2px solid; background: #fff; }\n    </style><script>\n    window.onload = function() {\n      const buttonBox = document.querySelector('.${d}');\n      buttonBox.addEventListener('click', e => {\n        const target = e.target;\n        if (target.classList.contains('${c}')) {\n          const sheets = document.querySelectorAll('.${a}');\n          for (let node of sheets) {\n            node.classList.remove('active');\n          }\n          for (let btn of buttonBox.children) {\n            btn.classList.remove('active');\n          }\n          const index = target.dataset.index;\n          document.querySelector('.${a}[data-index="'+index+'"]').classList.add('active');\n          e.target.classList.add('active');\n        }\n      })\n    }\n  <\/script>`,`<div class="${l}">${n}</div>`}(p,i.worksheets);return"arrayBuffer"===(null==n?void 0:n.output)?v(b):b},new((i=void 0)||(i=Promise))((function(t,e){function n(t){try{a(s.next(t))}catch(t){e(t)}}function l(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var o;e.done?t(e.value):(o=e.value,o instanceof i?o:new i((function(t){t(o)}))).then(n,l)}a((s=s.apply(o,r||[])).next())}));var o,r,i,s}function v(t){return new Blob([t],{type:"text/html"}).arrayBuffer()}})(),r})()}));
//# sourceMappingURL=xlsxPreview.umd.js.map